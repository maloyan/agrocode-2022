# AgroCode Hack

### Сборка модели.

Все данные по задаче должны храниться в папке data выданного репозитория.

Структура данных должна получиться следующая:

- data
    - queries
        - 0.png
        - 1.png
        …
        - N.png
    - test
        - 1.png
        - 3.png
        …
        - X.png
    - train
        - 0.png
        - 2.png
        …
        - Y.png
    - queries.csv
    - test.csv
    - train.csv
    - submission.csv
- weights
    - your-weights.h5

Для того, чтобы начать работу над проектом, склонируйте репозиторий в локальную папку (git clone <your repo URL> /your/local/folder). Репозиторий представляет собой готовый шаблон проекта и базовое решение задачи (run.py)

Для того, чтобы загрузить своё решение, измените run.py и сделайте git push в main ветку. 

После загрузки решения, ваша модель будет автоматически собираться с помощью предустановленного Dockerfile и Gitlab CI/CD пайплайна. Вам не нужно изменять Dockerfile, за исключением случаев, когда вы точно знаете, что делаете.

После успешной сборки вашей модели (логи сборки доступны в разделе CI/CD -> Jobs в левом меню репозитория), вы получите соответствующее email-уведомление, а в правой части экрана задачи, появится кнопка “Проверить решение”. Нажатие на эту кнопку запускает инференс модели.

_Все внешние зависимости должны быть установлены через requirements.txt и скачиваться в ходе сборки модели. На этапе инференса (запуска run.py), сервер не имеет доступа в интернет, поэтому попытка скачать что-либо приведёт к ошибке._

### Инференс модели.

Процесс расчёта модели происходит следующим образом:

1. Система берёт последнюю успешную сборку (коммит, который успешно собрался)

2. В директорию data подгружаются папки test, queries, а также файлы test.csv и queries.csv

3. Запускается файл run.py, результатом выполнения которого должен быть файл data/submission.csv 

4. Файл submission.csv прогоняется через расчет метрики (пример файла для расчета метрики ниже), результат записывается в лидерборд.

Если всё произошло успешно, вы получите соответствующее email уведомление и сможете увидеть свой результат в разделе “Предыдущие решения” на этой странице (кнопка в правом нижнем углу экрана).

